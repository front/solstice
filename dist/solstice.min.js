/**
 * A simple Solr wrapper for AngularJS apps
 * @version v0.1 - 2015-07-03
 * @link https://github.com/front/solstice
 * @author Élio Cró <elio@front.no>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(ng){"use strict";function SolsticeProvider(){function $get($http){function Solstice(endpoint){this.search=function(options){var url=endpoint+"/select/",defaults={wt:"json","json.wrf":"JSON_CALLBACK"};return ng.extend(defaults,options),$http.jsonp(url,{params:defaults})},this.withEndpoint=function(url){return new Solstice(url)}}return new Solstice(defEndpoint)}function setEndpoint(url){defEndpoint=url}var defEndpoint="";return{$get:["$http",$get],setEndpoint:setEndpoint}}function directive(){function controller($scope,$rootScope,Solstice){var searchServ=$scope.indexUrl?Solstice.withEndpoint($scope.indexUrl):Solstice,options={q:$scope.q||"*:*",start:$scope.start||0,rows:$scope.rows||10};$scope.sort&&(options.sort=$scope.sort),$scope.fl&&(options.fl=$scope.fl),searchServ.search(options).then(function(data){var res=data.data.response,transScope=$scope.$$nextSibling;transScope.solr=$rootScope.solr||{},transScope.solr.results=res.docs,transScope.solr.count=res.numFound})}return{restrict:"AE",transclude:!0,replace:!1,template:"<div ng-transclude></div>",scope:{q:"@query",start:"@",rows:"@",sort:"@",fl:"@fields",indexUrl:"@"},controller:["$scope","$rootScope","Solstice",controller]}}var solr=ng.module("solstice",[]);solr.provider("Solstice",[SolsticeProvider]),solr.directive("solrSearch",[directive])}(window.angular);